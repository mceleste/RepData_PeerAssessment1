---
title: 'Reproducible Research: Peer Assessment 1'
output:
  word_document: default
  html_document:
    keep_md: yes
---

# Reproducible Research: Peer Assessment 1

## R Code for loading and preprocessing the data

```{r, echo=TRUE}

## Load ggplot2 library
library(ggplot2)
## Load scales library
library(scales)

## Load the data (i.e. read.csv())
data <- read.csv("activity.csv")

# Sum the total number of steps per day
total <- aggregate(data$steps, list(date=data$date), sum)
total$steps <- total$x
total$date <- as.Date(total$date)

# Calculate the average number of steps per day
avg <- aggregate(x=data$steps, list(date=data$date), mean) 
avg.steps <- mean(data$steps, na.rm=TRUE)

# Calculate the median number of steps per day
med <- aggregate(x=data$steps, list(date=data$date), median)
med.steps <- median(data$steps, na.rm=TRUE)

# Make a histogram of the total number of steps taken each day
datebreaks <- as.Date(total$date)
p <- ggplot(total, aes(y=steps, x=date)) +geom_bar(stat="identity")
p <- p + theme(axis.text.x = element_text(angle=90, hjust=1))
p <- p + scale_x_date(breaks=datebreaks, labels=date_format("%b %d") )

```

Figure 1: Histogram of total number of steps per day

`r p `

The mean number of steps taken per day With missing values is: `r avg.steps`.

The median number of steps taken per day with missing values is: `r med.steps`.

```{r, echo=TRUE}

## Create interval bins of 1-288 (intervals per day)
data$intervalbin <- rep(seq(1,288))

## Calculate the average number of steps per interval
avginterval <- aggregate(x=data$steps, list(y=data$intervalbin), mean, na.rm=TRUE)

## Interval with the maximum number of steps
max.step <- avginterval$y[which.max(avginterval$x)]

## Time series plot of interval vs avg number of steps
p2 <- plot(avginterval$y, avginterval$x, type="l", xlab="Interval #", ylab="Avg. Steps")
```

## Figure 2: Time series plot of interval vs avg number of steps
` r p2 `

```{r, echo=TRUE}

## Calculate number of rows with missing values
num.rows.missing <- nrow(data[is.na(data$steps)==TRUE,])

## Calculate missing days/intervals
daysNA <- nrow(array(unique(data$date[is.na(data$steps)])))

## Create a new data set
## Copy the data frame
newdata <- data

## Imputing values strategy: assign the missing interval value the mean of the interval of all days
## Assign mean steps for each missing interval using means calculated above
newdata[is.na(newdata$steps)==TRUE,1] <- avginterval$x

```

Total number of rows missing: `r num.rows.missing `

Total numnber of days missing: `r daysNA `

```{r, echo=TRUE}

# Sum the total number of steps per day on the new dataset
total2 <- aggregate(newdata$steps, list(date=newdata$date), sum)
total2$steps <- total2$x
total2$date <- as.Date(total2$date)

# Create a histogram of the number of steps per day
datebreaks <- as.Date(total2$date)
p3 <- ggplot(total2, aes(y=steps, x=date)) +geom_bar(stat="identity")
p3 <- p3 + theme(axis.text.x = element_text(angle=90, hjust=1))
p3 <- p3 + scale_x_date(breaks=datebreaks, labels=date_format("%b %d") )

```

Figure 3: Histogram of total number of steps per day (new dataset with imputed values)
`r p3 `

## TODO
What is the impact of imputing missing data on the estimates of the total daily number of steps?

```{r, echo=TRUE}

## Setup a new factor and classify by Weekday and Weekend
newdata$day <- factor(weekdays(as.Date(newdata$date)))
levels(newdata$day)[1:2] <- "Weekday"
levels(newdata$day)[4:6] <- "Weekday"
levels(newdata$day)[2:3] <- "Weekend"

# Create a time series panel of two plots (weekdays and weekends)
p4 <- qplot(interval, steps, data=newdata, geom="line", facets=day~.)

```

Figure 4: Weekday vs Weekend Comparison Graph
`r p4 `
